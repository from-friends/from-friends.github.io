<!doctypehtml><html lang="en"><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><title>ObjktStats - How much is your Tezos NFT portfolio worth?</title><script src="objktstats/qrcode.min.js"></script><link rel="icon"type="image/png"href="favicon-96x96.png"sizes="96x96"><link rel="icon"type="image/svg+xml"href="favicon.svg"><link rel="shortcut icon"href="favicon.ico"><meta name="description"content="ObjktStats lets you instantly check stats of your Tezos NFT collection. Try now for free!"><meta name="keywords"content="objkt, tezos, nft, portfolio, valuation, floor price, crypto, blockchain, art, stats"><meta property="og:type"content="website"><meta property="og:url"content="https://from-friends.github.io/objktstats.html"><meta property="og:title"content="↗ ObjktStats - Your Tezos NFT Collection Stats"><meta property="og:description"content="ObjktStats lets you instantly check stats of your Tezos NFT collection. Try now for free!"><meta property="og:image"content="https://from-friends.github.io/objktstats/social-sharing_objktstats.png"><meta name="twitter:card"content="summary_large_image"><meta property="twitter:domain"content="from-friends.github.io"><meta property="twitter:url"content="https://from-friends.github.io/objktstats.html"><meta name="twitter:title"content="↗ ObjktStats - Your Tezos NFT Collection Stats"><meta name="twitter:description"content="ObjktStats lets you instantly check stats of your Tezos NFT collection. Try now for free!"><meta name="twitter:image"content="https://from-friends.github.io/objktstats/social-sharing_objktstats.png"><style>body{background-color:#121212;color:#e0e0e0;font-family:sans-serif;margin:0;padding:20px;padding-top:80px;display:flex;flex-direction:column;align-items:center}.toolbar{background-color:#121212;padding:10px 20px;display:flex;justify-content:space-between;align-items:center;position:fixed;top:0;left:0;width:100%;z-index:1100;box-sizing:border-box}.toolbar-logo img{height:40px;width:auto;display:block}.logo-text{font-size:28px;font-weight:700;color:#e0e0e0}.donate-button{width:100px;padding:10px 0;text-align:center;border-radius:8px;border:none;background-color:#ff5722;color:#121212;cursor:pointer;font-weight:700;font-size:.95em;text-decoration:none}.donate-button:not(:disabled):hover{background-color:#ff5722f3}h1{color:#fff}.input-section{display:flex;flex-direction:column;align-items:center;width:100%;max-width:400px;margin-bottom:20px}.input-section h1{color:#fff;font-size:1.8em;text-align:center;margin-bottom:15px}input[type=text]{padding:12px;margin-bottom:8px;border-radius:8px;border:1px solid #333;background-color:#1e1e1e;color:#e0e0e0;width:100%;box-sizing:border-box;font-size:1em}.input-section input[type=text]#addressInput{width:100%}button{padding:12px 20px;border-radius:8px;border:none;background-color:#ff5722;color:#121212;cursor:pointer;font-weight:700;width:90%;box-sizing:border-box;font-size:1.1em}.input-section button#fetchButton{width:100%;margin-bottom:15px}button:disabled{background-color:#555;color:#aaa;cursor:not-allowed}#fetchButton.loading-state{display:flex;align-items:center;justify-content:center;padding-top:12px;padding-bottom:12px}#fetchButton.loading-state .spinner{width:20px;height:20px;border-width:3px;margin:0 10px 0 0}button:not(:disabled):hover{background-color:#ff5722f3}table{width:90%;margin-top:20px;border-collapse:collapse;background-color:#121212}td,th{border:1px solid #333;padding:12px;text-align:left;vertical-align:middle}th{background-color:#333;color:#000}td img{max-width:80px;max-height:80px;border-radius:4px;display:block}#groupedFxhashTable a{color:#ccc;text-decoration:none}#groupedFxhashTable a:hover{text-decoration:underline}.error,.loading{margin-top:15px;font-size:1.1em}.error{color:#cf6679}.loading{color:#03dac6}#prominentTotalValueDisplay{font-size:1.6em;font-weight:700;color:#ff5722;text-align:center;margin-top:20px;margin-bottom:15px;padding:10px;background-color:#1e1e1e;border-radius:5px;width:80%;max-width:600px}.action-buttons-container{display:flex;justify-content:center;margin-top:20px;margin-bottom:20px;width:100%;max-width:460px}.action-buttons-container button{flex:1;padding:10px 20px;font-weight:700;border-radius:8px;cursor:pointer;font-size:1.1em;box-sizing:border-box;border:2px solid #ff5722;line-height:1.5}#shareButton{background-color:#ff5722;color:#121212}#shareButton:hover{background-color:#ff5722f3}.outline-button{background-color:transparent;color:#ff5722;transition:background-color .2s,color .2s}.outline-button:hover{background-color:#ff5722;color:#121212}.modal{display:none;position:fixed;z-index:1500;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.6);padding-top:60px}.modal-content{background-color:#2a2a2a;margin:5% auto;padding:20px;border:1px solid #555;width:80%;max-width:450px;border-radius:8px;position:relative;text-align:center}.close-modal-button{color:#aaa;float:right;font-size:28px;font-weight:700;position:absolute;top:10px;right:20px}.close-modal-button:focus,.close-modal-button:hover{color:#fff;text-decoration:none;cursor:pointer}#shareCanvasPreview{width:300px;height:300px;border:1px solid #555;margin:20px auto;background-color:#333}#shareCardTitle{font-size:1.5em}#shareCardValue{font-size:1.8em;font-weight:700;margin-bottom:20px;color:#03dac6}#shareCardLink{font-size:1em;color:#ff80bf}#shareCardLink a{color:#ff80bf;text-decoration:underline}.modal-buttons button{padding:10px 15px;margin:10px 5px;font-weight:700;border-radius:5px;cursor:pointer;border:none}#modalShareButton{background-color:#ff5722;color:#121212}#modalDownloadButton{background-color:#03dac6;color:#121212}.logo{position:absolute;top:20px;left:20px;width:100px;height:auto}.loading-overlay{display:none;position:fixed;z-index:2000;left:0;top:0;width:100%;height:100%;background-color:rgba(18,18,18,.85);justify-content:center;align-items:center;text-align:center;color:#e0e0e0;font-size:1.3em;flex-direction:column}.loading-overlay-content{padding:20px}.spinner{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #ff5722;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 10px auto}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.footer{background-color:#121212;color:#e0e0e0;padding:30px 20px;margin-top:40px;border-top:1px solid #333;display:flex;flex-direction:column;align-items:center;font-family:sans-serif}.footer-image{width:120px;height:auto;margin-bottom:25px}.footer-sections{display:flex;justify-content:space-around;width:100%;max-width:700px;flex-wrap:wrap}.footer-section{margin:15px;text-align:left;min-width:200px}.footer-section h3{color:#aaa;font-size:1.2em;margin-bottom:15px}.footer-links{list-style:none;padding:0;margin:0}.footer-links li{margin-bottom:8px}.footer-links li a{color:#aaa;text-decoration:none;font-size:.95em}.footer-links li a:hover{text-decoration:underline}.x-follow-btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 24px;background-color:#121212;color:#fff;border:none;border-radius:8px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s ease;text-decoration:none;box-shadow:0 0 0 2px #888,0 2px 5px rgba(0,0,0,.1);margin-top:15px}.x-follow-btn:hover{background-color:#222;transform:translateY(-1px);box-shadow:0 0 0 2px #888,0 4px 8px rgba(0,0,0,.15)}.x-follow-btn:active{transform:translateY(0);box-shadow:0 0 0 2px #888,0 2px 3px rgba(0,0,0,.1)}.x-follow-btn::before{content:"";display:inline-block;width:20px;height:20px;margin-right:10px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z'/%3E%3C/svg%3E");background-size:contain;background-repeat:no-repeat}.widget-container{width:460px;max-width:100%}.balance-card{background-color:#121212;color:#fff;padding:25px 20px;border-radius:10px;margin-bottom:5px}.balance-card .balance-title{font-size:18px;opacity:.8;margin-bottom:4px}.balance-card .balance-amount{font-size:38px;font-weight:700;margin-bottom:1px;letter-spacing:-.5px}.categories-section{background-color:#121212;border-radius:5px;padding:5px}.category-row{display:flex;justify-content:space-between;gap:15px}.category-row:not(:last-child){margin-bottom:15px}.category-box{background-color:#121212;border:none;border-radius:8px;padding:15px;flex:1;min-width:0;text-align:left}.category-box .category-amount{font-size:17px;font-weight:700;color:#f0f0f0;margin-bottom:4px}.category-box .category-label{font-size:11px;color:#aaa}.separator-line{border:none;height:1px;background-color:#444;margin:10px 0}@keyframes skeleton-loading{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}.skeleton{animation:skeleton-loading 1.5s infinite linear;background-color:#121212;background-image:linear-gradient(90deg,#121212,#2c2c2c,#121212);background-size:200px 100%;background-repeat:no-repeat;color:transparent!important;border-radius:4px;display:block}#donateModal{align-items:center;justify-content:center;padding-top:0}#donateModal .modal-content{background-color:#121212;margin:0;padding:20px;border:2px solid #444;width:90%;max-width:380px;border-radius:8px;position:relative;text-align:center}.close-donate-modal-button{color:#aaa;font-size:32px;font-weight:400;position:absolute;top:5px;right:5px;background-color:transparent;border:none;padding:10px;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;line-height:1;cursor:pointer;transition:background-color .2s,color .2s}.close-donate-modal-button:focus,.close-donate-modal-button:hover{color:#fff;background-color:rgba(255,255,255,.15);text-decoration:none}#donateModal .widget-container{width:100%}#donateModal .balance-card{background-color:#121212;color:#fff;padding:25px 20px;border-radius:10px;margin-bottom:5px}#donateModal .balance-title{font-size:18px;opacity:.8;margin-bottom:4px}#donateModal .actions-container{display:flex;gap:12px}#donateModal .action-button{flex:1;background-color:#fff;color:#121212;border:none;padding:12px 10px;border-radius:6px;font-size:14px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease}#donateModal .action-button:hover{background-color:#f0f0f0}#donateModal .profile-card{background-color:#121212;border-radius:10px;padding:15px;display:flex;align-items:center}#donateModal .profile-avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;margin-right:15px;border:1px solid #333}#donateModal .profile-info-text{text-align:left;flex-grow:1}#donateModal .profile-username{font-size:15px;font-weight:600;color:#e0e0e0;margin-bottom:2px}#donateModal .profile-address{font-size:11px;color:#aaa}#donateModal .qr-code-container{margin-top:20px;margin-bottom:20px;padding:10px;background-color:#121212;border-radius:8px;display:inline-block}#donateModal #qrcode img{display:block;margin:auto;border:none;border-radius:4px}#donateModal .action-button-grey-outline{flex:1;background-color:transparent;border:2px solid #555;color:#aaa;padding:12px 10px;border-radius:6px;font-size:14px;font-weight:600;cursor:pointer;text-decoration:none;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease,color .2s ease,border-color .2s ease}#donateModal .action-button-grey-outline:focus,#donateModal .action-button-grey-outline:hover{background-color:#555;color:#fff;border-color:#555}#donateModal .footer-content{text-align:center;margin-bottom:20px}#donateModal .footer-content p{font-size:14px;color:#aaa;margin-top:0;margin-bottom:0}.demo-link{font-size:.9em;color:#aaa;text-decoration:underline;cursor:pointer;background:0 0;border:none;padding:0}.demo-link:hover{color:#e0e0e0}@media (max-width:768px){body{padding-left:15px;padding-right:15px}.input-section,.widget-container{width:100%}.category-row{flex-direction:column;gap:10px}.action-buttons-container{flex-direction:column}.table-wrapper{overflow-x:auto;-webkit-overflow-scrolling:touch;border-radius:8px;margin-top:20px;width:100%}#groupedFxhashTable{min-width:700px;margin-top:0}#groupedFxhashTable td:first-child,#groupedFxhashTable th:first-child{position:-webkit-sticky;position:sticky;left:0;z-index:2;background-color:#1e1e1e;border-right:1px solid #444}#groupedFxhashTable td:first-child{background-color:#121212}}</style><script defer="defer"src="https://cloud.umami.is/script.js"data-website-id="77f26836-27dd-4d25-b9b0-dcf4cdf4b2b7"></script><header class="toolbar"><a href="https://from-friends.github.io"rel="noopener noreferrer"class="toolbar-logo"style="text-decoration:none"><span class="logo-text">ObjktStats</span> </a><button class="donate-button">Donate</button></header><a href="https://from-friends.github.io/"target="_blank"rel="noopener noreferrer"class="logo"><img src="objktstats/fromfriends.svg"alt="fromfriends logo"style="display:block;width:100%;height:auto"></a><div id="loadingOverlayModal"class="loading-overlay"><div class="spinner"></div><div id="loadingOverlayText"class="loading-overlay-content">Loading...</div><p style="margin-top:10px;margin-bottom:0;font-size:.9em">Follow us on X while the data loads:</p><a href="https://x.com/FromFriends__"class="x-follow-btn"target="_blank"rel="noopener noreferrer">Follow us on X @FromFriends__</a></div><div class="input-section"><h1>How much is your Tezos NFT collection worth?</h1><input type="text" id="addressInput" placeholder="Enter Tezos address (tz... or .tez)" value=""> <button id="fetchButton">Check now</button> <a href="#"id="demoLink"class="demo-link">Try a demo</a></div><div id="skeletonLoader"style="display:none;margin-top:10px"><div class="widget-container"><div class="balance-card"><div class="balance-title"><strong>ObjktStats</strong> ×</div><div class="balance-amount"id="resultsTotalValue"><div class="skeleton"style="width:200px;height:38px;border-radius:4px"></div></div><div class="category-label">Total Floor Value</div></div><div class="categories-section"><div class="category-row"><div class="category-box"><div class="category-amount"id="resultsCollectedIterations"><div class="skeleton"style="width:60px;height:17px;border-radius:3px"></div></div><div class="category-label">Collected Iterations</div></div><div class="category-box"><div class="category-amount"id="resultsTopArtist"><div class="skeleton"style="width:120px;height:17px;border-radius:3px"></div></div><div class="category-label">#1 Artist</div><div id="topArtistDetails"class="category-label"style="margin-top:4px;height:12px"></div></div></div><div class="category-row"><div class="category-box"><div class="category-amount"id="resultsUniqueArtists"><div class="skeleton"style="width:50px;height:17px;border-radius:3px"></div></div><div class="category-label">Unique Artists</div></div><div class="category-box"><div class="category-amount"id="resultsMostValuable"><div class="skeleton"style="width:100px;height:17px;border-radius:3px"></div></div><div class="category-label">Most Valuable Artwork</div><div id="mostValuableDetails"class="category-label"style="margin-top:4px;height:24px"></div></div></div><div class="category-row"><div class="category-box"><div class="category-amount"id="resultsAverageValue"><div class="skeleton"style="width:80px;height:17px;border-radius:3px"></div></div><div class="category-label">Average NFT Value</div></div><div class="category-box"><div class="category-amount"id="resultsListedRatio"><div class="skeleton"style="width:70px;height:17px;border-radius:3px"></div></div><div class="category-label">Listed For Sale</div></div></div></div><div id="platformDistributionSection"class="categories-section"style="margin-top:5px;padding-top:15px;display:none"><div class="balance-title"style="font-size:16px;margin-bottom:10px;padding-left:10px">Platform Distribution</div><div id="platformDistributionBody"style="padding:0 5px"></div></div></div><div id="prominentTotalValueDisplay"style="display:none"></div><div class="action-buttons-container"><button id="shareButton"style="display:none">Share on 𝕏</button></div></div><div style="margin-top:15px;margin-bottom:10px;display:none"><input type="checkbox"id="toggleThumbnailsCheckbox"checked="checked"> <label for="toggleThumbnailsCheckbox">Hide Thumbnails</label></div><div id="statusMessage"class="loading"style="display:none">Loading...</div><div id="errorMessage"class="error"style="display:none"></div><table id="artworksTable"style="display:none"><thead><tr><th>ID<th>Title<th>Contract<th>Image<th>ID<tbody id="artworksTableBody"></table><div class="table-container"style="width:100%;max-width:90vw"><div id="groupedFxhashStatusMessage"class="loading"style="display:none;margin-top:20px"></div><div id="fxhashTokenCountDisplay"style="margin-top:10px;margin-bottom:5px;font-weight:700;text-align:center"></div><div class="table-wrapper"><table id="groupedFxhashTable"style="display:none;margin-top:20px"><thead><tr><th>Thumbnail<th>Floor Price<th>Artist<th>Title<th>ID<th>Token<th>Contract<tbody id="groupedFxhashTableBody"><tfoot id="groupedFxhashTableFooter"></table></div></div><div id="endOfPageDonateSection"style="display:none;margin-top:40px;text-align:center"><p style="color:#aaa;margin-bottom:15px;font-size:1.1em">Enjoying this tool? Show your support.</p><button class="donate-button"style="width:150px;padding:12px 20px">Donate</button></div><div id="sharePreviewModal"class="modal"><div class="modal-content"><span class="close-modal-button">&times;</span><h2>Share Your Valuation</h2><canvas id="shareCanvasPreview"></canvas><p style="font-size:.9em;color:#aaa">Note: This is a visual preview. Sharing will attempt to use the image; downloading provides the image.<div class="modal-buttons"><button id="modalShareButton">Share Image</button> <button id="modalDownloadButton">Download Image</button></div></div></div><div id="donateModal"class="modal"><div class="modal-content"><span class="close-donate-modal-button">&times;</span><div class="widget-container"><div class="balance-title"style="text-align:center;margin-bottom:15px"><strong>DONATE</strong></div><div class="footer-content"><p>Many thanks for your support! 🫶</div><div class="profile-card"style="margin-top:15px"><img src="objktstats/avatar-placeholder.jpg"alt="Donation Avatar"class="profile-avatar"><div class="profile-info-text"><div class="profile-username">fromfriends.tez</div><div class="profile-address"id="tezosAddressValue">tz1U49JkLGSUR7JFN5xFoFghNwMXnQtR7Pv5</div></div></div><div class="balance-card"><div class="actions-container"style="margin-top:-20px;display:flex;gap:10px"><button type="button"id="copyAddressBtn"class="action-button">Copy Address</button> <a href="https://kukai.app"target="_blank"rel="noopener noreferrer"class="action-button-grey-outline">Open Kukai Wallet</a></div><div style="text-align:center;margin-top:40px"><p style="font-size:.9em;color:#aaa;margin-bottom:8px">Scan the FromFriends Tezos address<div class="qr-code-container"style="margin-top:0;margin-bottom:10px"><div id="qrcode"></div></div></div></div><hr class="separator-line"></div></div></div><script>let ownedLoading=!1,ownedError=null,ownedItems=[],showThumbnails=!0;const addressInput=document.getElementById("addressInput"),demoLink=document.getElementById("demoLink"),fetchButton=document.getElementById("fetchButton"),artworksTable=document.getElementById("artworksTable"),artworksTableBody=document.getElementById("artworksTableBody"),statusMessage=document.getElementById("statusMessage"),errorMessage=document.getElementById("errorMessage"),toggleThumbnailsCheckbox=document.getElementById("toggleThumbnailsCheckbox"),shareButton=document.getElementById("shareButton"),loadingOverlayModal=document.getElementById("loadingOverlayModal"),loadingOverlayText=document.getElementById("loadingOverlayText"),donateButtons=document.querySelectorAll(".donate-button"),donateModal=document.getElementById("donateModal"),closeDonateModalButton=document.querySelector(".close-donate-modal-button");let qrCodeGenerated=!1;const sharePreviewModal=document.getElementById("sharePreviewModal"),closeModalButton=document.querySelector(".close-modal-button"),shareCanvasPreview=document.getElementById("shareCanvasPreview"),modalShareButton=document.getElementById("modalShareButton"),modalDownloadButton=document.getElementById("modalDownloadButton");async function resolveTezosDomain(e){const t=e.trim(),n=t.toLowerCase();if(errorMessage.style.display="none",!n.endsWith(".tez"))return{success:!0,address:t,message:"Input is a direct address."};try{const e={query:`{\n                        domain(name: "${n}") {\n                            name\n                            address\n                        }\n                    }`},o=await fetch("https://api.tezos.domains/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)});if(o.ok){const e=await o.json();return console.log("Tezos Domains API response for",n,":",e),e.data&&e.data.domain&&e.data.domain.address?{success:!0,address:e.data.domain.address,domainName:e.data.domain.name}:e.data&&null===e.data.domain?{success:!1,error:`Domain '${t}' not found or has no address.`}:e.errors?{success:!1,error:`API Error: ${e.errors.map((e=>e.message)).join(", ")}`}:{success:!1,error:"Could not resolve domain. Unexpected API response."}}{const e=await o.text();return console.error("Tezos Domains API request failed:",o.status,e),{success:!1,error:`API request failed with status ${o.status}.`}}}catch(e){return console.error("Error during domain resolution:",e),{success:!1,error:`An unexpected error occurred during resolution: ${e.message}`}}}function formatIpfsUrl(e){return e&&e.startsWith("ipfs://")?`https://ipfs.io/ipfs/${e.substring(7)}`:e}function formatArtist(e){if(!e||!e.holder)return"Unknown";if(e.holder.alias)return e.holder.alias;if(e.holder.address){const t=e.holder.address;return`${t.slice(0,6)}...${t.slice(-4)}`}return"Unknown"}function truncateAddress(e,t=5,n=5){if(!e||e.length<=t+n+3)return e;return`${e.substring(0,t)}...${e.substring(e.length-n)}`}async function getDisplayNameForAddress(e){try{const t=await fetch(`https://api.tzkt.io/v1/accounts/${e}`);if(t.ok){const e=await t.json();if(e.alias)return e.alias}}catch(t){console.error(`Error fetching account alias from TzKT for ${e}`,t)}try{const t={query:`{ reverseRecord(address: "${e}") { domain { name } } }`},n=await fetch("https://api.tezos.domains/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n.ok){const e=await n.json();if(e.data?.reverseRecord?.domain?.name)return e.data.reverseRecord.domain.name}}catch(t){console.error(`Error fetching reverse record from Tezos Domains for ${e}`,t)}try{const t=await fetch(`https://api.tzkt.io/v1/domains/${e}/reverse`);if(t.ok){const e=await t.text();if(e){const t=JSON.parse(e).name;if(t)return t}}}catch(t){console.error(`TzKT reverse lookup for ${e} failed`,t)}return null}function drawShareImageOnCanvas(e,t){const n=e.getContext("2d"),o=1080,s=1080;e.width=o,e.height=s,n.fillStyle="#333333",n.fillRect(0,0,o,s),n.fillStyle="#FF5722",n.font="bold 72px sans-serif",n.textAlign="center",n.fillText("My fx(hash) portfolio valuation",540,324),n.fillStyle="#03dac6",n.font="bold 120px sans-serif",n.fillText(t,540,594),n.fillStyle="#ff80bf",n.font="italic 50px sans-serif",n.fillText("via floorcheck.com",540,810)}async function fetchOwned(e){ownedLoading=!0,ownedError=null,ownedItems=[],errorMessage.style.display="none",artworksTable.style.display="none",document.getElementById("groupedFxhashTable").style.display="none",document.getElementById("groupedFxhashStatusMessage").style.display="none",document.getElementById("groupedFxhashTableBody").innerHTML="",document.getElementById("groupedFxhashTableFooter").innerHTML="";let t=0,n=!0;for(;n;){const o='\n              query GetHolderTokens($address: String!, $limit: Int!, $offset: Int!) {\n                token_holder(\n                  where: {\n                    holder_address: {_eq: $address},\n                    token: {\n                      supply: {_gt: "0"}\n                    }\n                  },\n                  limit: $limit,\n                  offset: $offset,\n                  order_by: {token: {pk: desc}}\n                ) {\n                  token {\n                    pk\n                    token_id\n                    name\n                    display_uri\n                    artifact_uri\n                    thumbnail_uri\n                    creators {\n                      holder {\n                        address\n                        alias\n                      }\n                    }\n                    fa {\n                        contract\n                        name\n                    }\n                    listings(\n                      where: {\n                        status: {_eq: "active"},\n                        currency_id: {_eq: 1} # Filter for listings in XTZ\n                      },\n                      order_by: {price: asc},\n                      limit: 1\n                    ) {\n                      price\n                    }\n                  }\n                }\n              }\n            ';try{const s=await fetch("https://data.objkt.com/v3/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:o,variables:{address:e,limit:500,offset:t}})}),a=await s.json();if(console.log(`Owned Tokens API Response (Offset: ${t}):`,a),a.errors)throw new Error(a.errors.map((e=>e.message)).join(", "));const l=a.data.token_holder.map((e=>e.token));if(l&&l.length>0){const e=l.map((async e=>{let t=e.thumbnail_uri||e.display_uri||e.artifact_uri;t=formatIpfsUrl(t);const n=e.listings&&e.listings.length>0?e.listings[0].price:null,o=e.fa&&e.fa.name?e.fa.name:"",s=e.creators&&e.creators.length>0?e.creators[0]:null,a=formatArtist(s),l=s&&s.holder?s.holder.address:null,r=e.fa&&e.fa.contract?e.fa.contract:null,i=e.token_id?e.token_id:null;return{id:e.pk,title:e.name||"Untitled Token",contractName:o||"N/A",image:t||"placeholder_small_dark.jpg",floorPrice:n,artistDisplay:a,artistObjktAddress:l,faContract:r,tokenId:i}})),o=await Promise.all(e);ownedItems.push(...o),fetchButton.innerHTML=`<div class="spinner"></div>Fetched ${ownedItems.length} tokens...`,l.length<500?n=!1:(t+=500,await new Promise((e=>setTimeout(e,200))))}else n=!1,0===ownedItems.length&&(statusMessage.textContent="No owned tokens found for this user.")}catch(e){ownedError=`Error during fetch (Offset: ${t}): ${e.message}`,n=!1,errorMessage.textContent=ownedError,errorMessage.style.display="block",console.error("Error fetching owned tokens:",e)}}if(ownedLoading=!1,ownedError)document.getElementById("skeletonLoader").style.display="none",artworksTable.style.display="none",document.getElementById("groupedFxhashTable").style.display="none";else{ownedItems.length>0?statusMessage.style.display="none":statusMessage.style.display="block";const e=ownedItems.filter((e=>!e.contractName||!e.contractName.toLowerCase().includes("fxhash")&&!e.contractName.toLowerCase().includes("fx(hash)")));renderTokensTable(e),artworksTable.style.display="none",logPortfolioInsights(e)}}function renderTokensTable(e){const t=document.getElementById("groupedFxhashTableBody"),n=document.getElementById("groupedFxhashTable"),o=document.getElementById("groupedFxhashStatusMessage"),s=document.getElementById("groupedFxhashTableFooter");let a=document.getElementById("shareButton");if(t.innerHTML="",s.innerHTML="",a.style.display="none",0===e.length)return n.style.display="none",o.textContent="No tokens found to display.",void(o.style.display="block");n.style.display="table",o.style.display="none";let l=0;console.log("--- Calculating Total Token Floor Value ---"),e.forEach((e=>{null!==e.floorPrice&&void 0!==e.floorPrice&&(l+=e.floorPrice,console.log(`Token: ${e.title}, Floor: ${e.floorPrice/1e6} XTZ, Contributing to Total: ${e.floorPrice/1e6} XTZ`));const n=t.insertRow(),o=n.insertCell();if(showThumbnails){const t=document.createElement("img");if(t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.dataset.src=e.image,t.alt=e.title,t.classList.add("lazy-load"),t.onerror=function(){this.style.display="none";const e=document.createElement("span");e.textContent="No Image",this.parentElement.appendChild(e)},e.faContract&&e.tokenId){const n=document.createElement("a");n.href=`https://objkt.com/tokens/${e.faContract}/${e.tokenId}?ref=tz1U49JkLGSUR7JFN5xFoFghNwMXnQtR7Pv5`,n.target="_blank",n.rel="noopener noreferrer",n.appendChild(t),o.appendChild(n)}else o.appendChild(t)}else o.textContent="(hidden)";const s=n.insertCell();s.dataset.label="Floor Price",null!==e.floorPrice&&void 0!==e.floorPrice?s.innerHTML=`<strong>${e.floorPrice/1e6}</strong> ꜩ`:s.textContent="N/A";const a=n.insertCell();if(a.dataset.label="Artist",e.artistObjktAddress){const t=document.createElement("a");t.href=`https://objkt.com/profile/${e.artistObjktAddress}?ref=tz1U49JkLGSUR7JFN5xFoFghNwMXnQtR7Pv5`,t.textContent=e.artistDisplay.length>20?e.artistDisplay.substring(0,17)+"...":e.artistDisplay,t.target="_blank",t.rel="noopener noreferrer",a.appendChild(t)}else a.textContent=e.artistDisplay.length>20?e.artistDisplay.substring(0,17)+"...":e.artistDisplay;a.style.verticalAlign="top";const r=n.insertCell();if(r.dataset.label="Title",e.faContract&&e.tokenId){const t=document.createElement("a");t.href=`https://objkt.com/tokens/${e.faContract}/${e.tokenId}?ref=tz1U49JkLGSUR7JFN5xFoFghNwMXnQtR7Pv5`,t.textContent=(e.title||"Untitled").length>20?(e.title||"Untitled").substring(0,17)+"...":e.title||"Untitled",t.target="_blank",t.rel="noopener noreferrer",r.appendChild(t)}else r.textContent=(e.title||"Untitled").length>20?(e.title||"Untitled").substring(0,17)+"...":e.title||"Untitled";const i=n.insertCell();i.dataset.label="ID";const d=e.id?e.id.toString():"";i.textContent=d.length>10?d.substring(0,7)+"...":d;const c=n.insertCell();c.dataset.label="Token ID";const u=e.tokenId?e.tokenId.toString():"";c.textContent=u.length>10?u.substring(0,7)+"...":u;const m=n.insertCell();m.dataset.label="Contract",m.textContent=(e.contractName||"N/A").length>20?(e.contractName||"N/A").substring(0,17)+"...":e.contractName||"N/A"}));const r=t.querySelectorAll(".lazy-load");if("IntersectionObserver"in window){let e=new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){let n=e.target;n.src=n.dataset.src,n.classList.remove("lazy-load"),t.unobserve(n)}}))}));r.forEach((t=>{e.observe(t)}))}else r.forEach((e=>{e.src=e.dataset.src}));console.log("---------------------------------------------------------------------");if(renderPortfolioInsights(e,l/1e6),l>0){a.style.display="block";const e=a.cloneNode(!0);a.parentNode.replaceChild(e,a),a=e,a.addEventListener("click",(()=>{const e=document.getElementById("resultsTotalValue").textContent,t=document.getElementById("resultsCollectedIterations").textContent,n=document.getElementById("resultsTopArtist").textContent,o=document.getElementById("resultsUniqueArtists").textContent,s=document.getElementById("resultsMostValuable").textContent,a=`https://twitter.com/intent/tweet?text=${encodeURIComponent(`Just checked my Tezos collection stats. ✨\n\n💰 Total Floor Value: ${e}\n🖼️ Collected NFTs: ${t}\n🎨 #1 Artist: ${n}\n👤 Unique Artists: ${o}\n💎 Most Valuable NFT: ${s}\n\n👉 Check your stats here: https://from-friends.github.io/objktstats.html via @FromFriends__`)}`;window.open(a,"_blank")}))}else a.style.display="none";if(e.length>0){const e=s.insertRow(),t=e.insertCell();t.colSpan=1,t.textContent="Total Value:",t.style.textAlign="right",t.style.fontWeight="bold";const n=e.insertCell();n.innerHTML=`<strong>${(l/1e6).toLocaleString()}</strong> ꜩ`,n.style.fontWeight="bold";e.insertCell().colSpan=5,document.getElementById("endOfPageDonateSection").style.display="block"}}function renderTable(){artworksTableBody.innerHTML="";let e=ownedItems;0!==e.length&&e.forEach((e=>{const t=artworksTableBody.insertRow();t.insertCell().textContent=e.id,t.insertCell().textContent=e.title,t.insertCell().textContent=e.contractName;const n=t.insertCell();if(showThumbnails){const t=document.createElement("img");t.src=e.image,t.alt=e.title,n.appendChild(t)}t.insertCell().textContent=e.galleryId}))}fetchButton.addEventListener("click",(async()=>{fetchButton.disabled=!0,fetchButton.classList.add("loading-state"),fetchButton.innerHTML='<div class="spinner"></div>Fetching tokens...';try{const e=addressInput.value.trim();if(!e)return errorMessage.textContent="Please enter a Tezos address or .tez domain.",errorMessage.style.display="block",statusMessage.style.display="none",artworksTable.style.display="none",void(document.getElementById("groupedFxhashTable").style.display="none");localStorage.setItem("lastFxhashAddress",e);const t=new URL(window.location);t.searchParams.set("address",e),window.history.pushState({},"",t),resetResultsCard(),document.getElementById("endOfPageDonateSection").style.display="none",document.getElementById("groupedFxhashTableBody").innerHTML="",document.getElementById("groupedFxhashTableFooter").innerHTML="",document.getElementById("groupedFxhashTable").style.display="none",document.getElementById("groupedFxhashStatusMessage").style.display="none",errorMessage.style.display="none",statusMessage.textContent="",statusMessage.style.display="block";document.getElementById("skeletonLoader").style.display="block";document.querySelector(".input-section").scrollIntoView({behavior:"smooth",block:"start"});document.querySelector(".balance-title").innerHTML='<strong>ObjktStats</strong> × <span id="displayNameSpan"></span>';const n=document.getElementById("displayNameSpan");let o=e,s=null;if(e.toLowerCase().endsWith(".tez")){const t=await resolveTezosDomain(e);if(!t.success||!t.address)return errorMessage.textContent=`Failed to resolve domain: ${t.error||"Unknown error"}`,errorMessage.style.display="block",void(statusMessage.style.display="none");o=t.address,s=t.domainName||e,n.textContent=s}else n.textContent=truncateAddress(o),statusMessage.textContent="",statusMessage.style.display="block";getDisplayNameForAddress(o).then((e=>{e&&(n.textContent=e)})),ownedItems=[],ownedLoading=!1,ownedError=null,document.getElementById("shareButton").style.display="none",await fetchOwned(o)}finally{fetchButton.disabled=!1,fetchButton.classList.remove("loading-state"),fetchButton.innerHTML="Check now"}})),addressInput.addEventListener("input",(()=>{if(""===addressInput.value.trim()){const e=new URL(window.location);e.searchParams.delete("address"),window.history.pushState({},"",e),localStorage.removeItem("lastFxhashAddress")}})),closeModalButton&&(closeModalButton.onclick=function(){sharePreviewModal.style.display="none"}),window.onclick=function(e){e.target==sharePreviewModal&&(sharePreviewModal.style.display="none"),e.target==donateModal&&(donateModal.style.display="none")},donateButtons.length>0&&donateButtons.forEach((e=>{e.addEventListener("click",(()=>{if(donateModal.style.display="flex",!qrCodeGenerated){const e="tz1U49JkLGSUR7JFN5xFoFghNwMXnQtR7Pv5";new QRCode(document.getElementById("qrcode"),{text:e,width:180,height:180,colorDark:"#e0e0e0",colorLight:"#121212",correctLevel:QRCode.CorrectLevel.H}),qrCodeGenerated=!0}}))})),closeDonateModalButton&&closeDonateModalButton.addEventListener("click",(function(){donateModal.style.display="none"}));const copyBtn=document.getElementById("copyAddressBtn");function resetResultsCard(){document.getElementById("resultsTotalValue").innerHTML='<div class="skeleton" style="width: 200px; height: 38px; border-radius: 4px;"></div>',document.getElementById("resultsCollectedIterations").innerHTML='<div class="skeleton" style="width: 60px; height: 17px; border-radius: 3px;"></div>',document.getElementById("resultsTopArtist").innerHTML='<div class="skeleton" style="width: 120px; height: 17px; border-radius: 3px;"></div>',document.getElementById("topArtistDetails").innerHTML='<div class="skeleton" style="width: 60px; height: 11px; margin-top: 4px; border-radius: 3px;"></div>',document.getElementById("resultsUniqueArtists").innerHTML='<div class="skeleton" style="width: 50px; height: 17px; border-radius: 3px;"></div>',document.getElementById("resultsMostValuable").innerHTML='<div class="skeleton" style="width: 100px; height: 17px; border-radius: 3px;"></div>',document.getElementById("mostValuableDetails").innerHTML='<div class="skeleton" style="width: 150px; height: 11px; margin-top: 4px; border-radius: 3px;"></div>',document.getElementById("resultsAverageValue").innerHTML='<div class="skeleton" style="width: 80px; height: 17px; border-radius: 3px;"></div>',document.getElementById("resultsListedRatio").innerHTML='<div class="skeleton" style="width: 70px; height: 17px; border-radius: 3px;"></div>',document.getElementById("platformDistributionSection").style.display="none",document.getElementById("platformDistributionBody").innerHTML=""}function renderPortfolioInsights(e,t){document.getElementById("resultsTotalValue").textContent=`${t.toLocaleString()} ꜩ`,e||(e=[]),document.getElementById("resultsCollectedIterations").textContent=e.length;const n={};e.forEach((e=>{const t=e.artistDisplay;t&&"N/A"!==t&&"Unknown"!==t&&(n[t]=(n[t]||0)+1)}));const o=Object.keys(n).length;document.getElementById("resultsUniqueArtists").textContent=o;let s=0,a=["N/A"];if(o>0){a=[];for(const e in n)n[e]>s?(s=n[e],a=[e]):n[e]===s&&a.push(e);document.getElementById("resultsTopArtist").textContent=a.join(", "),document.getElementById("topArtistDetails").textContent=`(${s} edition${s>1?"s":""})`}else document.getElementById("resultsTopArtist").textContent="N/A",document.getElementById("topArtistDetails").textContent="";const l=e.filter((e=>null!==e.floorPrice&&void 0!==e.floorPrice));let r=-1,i=[];if(l.length>0)if(l.forEach((e=>{e.floorPrice>r?(r=e.floorPrice,i=[e]):e.floorPrice===r&&i.push(e)})),r>=0){document.getElementById("resultsMostValuable").textContent=`${(r/1e6).toLocaleString()} ꜩ`;const e=i.map((e=>`'${e.title}' by ${e.artistDisplay}`)).join(", ");document.getElementById("mostValuableDetails").textContent=e}else document.getElementById("resultsMostValuable").textContent="N/A",document.getElementById("mostValuableDetails").textContent="";else document.getElementById("resultsMostValuable").textContent="N/A",document.getElementById("mostValuableDetails").textContent="";if(l.length>0){const e=l.map((e=>e.floorPrice)).sort(((e,t)=>e-t)),t=Math.floor(.1*e.length),n=e.slice(t,e.length-t),o=n.reduce(((e,t)=>e+t),0),s=n.length>0?o/n.length:0;document.getElementById("resultsAverageValue").textContent=`${(s/1e6).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})} ꜩ`}else document.getElementById("resultsAverageValue").textContent="0.00 ꜩ";const d=l.length,c=e.length;document.getElementById("resultsListedRatio").textContent=`${d} / ${c}`;const u={HEN:0,OBJKT:0,Versum:0,fxhash:0,Other:0};e.forEach((e=>{const t=e.contractName?e.contractName.toLowerCase():"";t.includes("hic et nunc")||t.includes("hen")?u.HEN++:t.includes("objkt")?u.OBJKT++:t.includes("versum")?u.Versum++:t.includes("fxhash")||t.includes("fx(hash)")?u.fxhash++:u.Other++}));const m=document.getElementById("platformDistributionBody"),h=document.getElementById("platformDistributionSection");m.innerHTML="";let g=Object.entries(u).filter((([,e])=>e>0));g.length>0?(h.style.display="block",g.sort(((e,t)=>t[1]-e[1])),g.forEach((([e,t])=>{const n=document.createElement("div");n.className="category-row",n.style.marginBottom="8px",n.innerHTML=`\n                        <div class="category-box" style="padding: 10px; display: flex; justify-content: space-between; align-items: center;">\n                            <span class="category-label" style="font-size: 14px;">${e}</span>\n                            <span class="category-amount" style="font-size: 14px;">${t}</span>\n                        </div>\n                    `,m.appendChild(n)}))):h.style.display="none"}function logPortfolioInsights(e){if(!e||0===e.length)return void console.log("Portfolio Insights: No items to analyze.");if(console.log("--- Portfolio Insights ---"),console.log(`Total Owned Tokens (fetched): ${e.length}`),0===e.length)return console.log("Portfolio Insights: No items to analyze for further artist/value breakdown."),void console.log("-------------------------");const t={};e.forEach((e=>{const n=e.artistObjktAddress||e.artistDisplay;n&&"N/A"!==n&&"Unknown"!==n&&(t[n]=(t[n]||0)+1)}));let n=0,o=[];if(Object.keys(t).length>0){const e=Object.keys(t).length;console.log(`Total Unique Artists: ${e}`);for(const e in t)t[e]>n?(n=t[e],o=[e]):t[e]===n&&o.push(e);console.log(`Most Collected Artist(s) (with ${n} token(s) each):`),o.forEach((e=>console.log(`- ${e}`)))}else console.log("Portfolio Insights: Could not determine most collected artists (no valid artist data).");let s=-1;const a=e.filter((e=>null!==e.floorPrice&&void 0!==e.floorPrice));if(a.forEach((e=>{e.floorPrice>s&&(s=e.floorPrice)})),s>=0){const e=a.filter((e=>e.floorPrice===s));console.log(`Highest Floor Price Found: ${s/1e6} ꜩ`),console.log("Artwork(s) with this Floor Price:"),e.forEach((e=>{console.log(`- "${e.title}" (Artist: ${e.artistDisplay}, Floor: ${e.floorPrice/1e6} ꜩ)`)}))}else console.log("Portfolio Insights: Could not determine most valuable artworks by floor (no valid floor price data).");const l={HEN:0,OBJKT:0,Versum:0,fxhash:0,Other:0};e.forEach((e=>{const t=e.contractName?e.contractName.toLowerCase():"";t.includes("hic et nunc")||t.includes("hen")?l.HEN++:t.includes("objkt")?l.OBJKT++:t.includes("versum")?l.Versum++:t.includes("fxhash")||t.includes("fx(hash)")?l.fxhash++:l.Other++})),console.log("Platform Distribution:");for(const e in l)l[e]>0&&console.log(`- ${e}: ${l[e]}`);console.log("-------------------------")}copyBtn&&copyBtn.addEventListener("click",(function(){navigator.clipboard.writeText("tz1U49JkLGSUR7JFN5xFoFghNwMXnQtR7Pv5").then((function(){const e=copyBtn.textContent;copyBtn.textContent="Copied!",setTimeout((function(){copyBtn.textContent=e}),2e3)})).catch((function(e){console.error("Failed to copy text: ",e)}))})),modalShareButton&&modalShareButton.addEventListener("click",(async()=>{const e="My fx(hash) portfolio valuation",t=document.getElementById("resultsTotalValue").textContent||"N/A",n=`${e}: ${t}.`,o="https://x";navigator.share&&shareCanvasPreview.toBlob?shareCanvasPreview.toBlob((async t=>{if(t){const s=new File([t],"objktstats_valuation.png",{type:"image/png"});try{await navigator.share({files:[s],title:e,text:n,url:o}),console.log("Image shared successfully!")}catch(t){console.error("Error sharing image:",t);try{await navigator.share({title:e,text:n,url:o})}catch(e){navigator.clipboard.writeText(`${n} ${o}`).then((()=>alert("Valuation info copied to clipboard! (Image share failed)"))).catch((e=>console.error("Failed to copy to clipboard:",e)))}}}else try{await navigator.share({title:e,text:n,url:o})}catch(e){navigator.clipboard.writeText(`${n} ${o}`).then((()=>alert("Valuation info copied to clipboard! (Image generation failed)"))).catch((e=>console.error("Failed to copy to clipboard:",e)))}}),"image/png"):navigator.clipboard.writeText(`${n} ${o}`).then((()=>alert("Valuation info copied to clipboard! (Sharing not fully supported)"))).catch((e=>console.error("Failed to copy to clipboard:",e)))})),modalDownloadButton&&modalDownloadButton.addEventListener("click",(()=>{const e=document.getElementById("resultsTotalValue").textContent||"0 ꜩ";drawShareImageOnCanvas(shareCanvasPreview,e);const t=shareCanvasPreview.toDataURL("image/png"),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download","fxhash_portfolio_valuation.png"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)})),demoLink&&demoLink.addEventListener("click",(e=>{e.preventDefault(),addressInput.value="tz1U49JkLGSUR7JFN5xFoFghNwMXnQtR7Pv5",fetchButton.click()})),function(){const e=new URLSearchParams(window.location.search).get("address");if(e)addressInput.value=decodeURIComponent(e),setTimeout((()=>fetchButton.click()),100);else{const e=localStorage.getItem("lastFxhashAddress");e&&(addressInput.value=e)}}();const downloadStatsButton=document.getElementById("downloadStatsButton");downloadStatsButton&&downloadStatsButton.addEventListener("click",(()=>{const e=document.querySelector(".widget-container");downloadStatsButton.textContent="Generating...",downloadStatsButton.disabled=!0,setTimeout((()=>{html2canvas(e,{backgroundColor:"#121212",useCORS:!0,scale:2}).then((e=>{const t=e.toDataURL("image/png");if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){window.open().document.write(`<body style="margin:0; background-color:#121212;"><img src="${t}" style="width:100%;"></body>`)}else{const e=document.createElement("a");e.setAttribute("href",t),e.setAttribute("download","objkt-stats.png"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}})).catch((e=>{console.error("html2canvas failed:",e),alert("Sorry, there was an error generating the image.")})).finally((()=>{downloadStatsButton.textContent="Download as Image",downloadStatsButton.disabled=!1}))}),100)}))</script><footer class="footer"><img src="objktstats/fromfriends.svg"alt="From Friends Logo"class="footer-image"><div class="footer-sections"><div class="footer-section"><h3>Tezos Tools</h3><ul class="footer-links"><li><a href="https://from-friends.github.io/teztracker.html"target="_blank"rel="noopener noreferrer">TezTracker</a><li><a href="https://from-friends.github.io/"target="_blank"rel="noopener noreferrer">FrameToGo</a><li><a href="https://tiktoktezos.netlify.app/"target="_blank"rel="noopener noreferrer">TikTok for Tezos</a></ul></div><div class="footer-section"><h3>Contact FromFriends</h3><ul class="footer-links"><li><a href="https://x.com/FromFriends__"target="_blank"rel="noopener noreferrer">Follow on X</a><li><a href="mailto:heyfromfriends@gmail.com">Email</a><li><a href="https://from-friends.github.io/"target="_blank"rel="noopener noreferrer">Website</a></ul></div></div></footer>